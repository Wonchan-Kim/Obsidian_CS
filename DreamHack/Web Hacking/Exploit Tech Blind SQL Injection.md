## Binary Search

Binary search is an efficient algorithm for finding a value within a sorted list. The process involves these two steps:

1.  **Define the search range:** Start with the entire range of possible values.
2.  **Narrow the range:** Repeatedly eliminate half of the search range based on whether the target value is greater or less than the midpoint of the current range.

### Binary Search Example

Suppose a database table is structured as follows:

| username | password |
| :--- | :--- |
| `admin` | `P@ssword` |

We can exploit a blind SQL injection vulnerability by using the `substr` function to guess the password one character at a time. Since printable ASCII characters range from 32 to 126, we can start by checking if the ASCII value of the first character is greater than 79 (the median of the range).

```sql
-- Check if the ASCII value of the first character of the password is greater than 79
SELECT * FROM users WHERE username = 'admin' AND ascii(substr(password, 1, 1)) > 79;
```

If the query returns a result, it means the condition is true. Since the first character of the password is 'P' (ASCII 80), the query will return the `admin` row. This tells us that the first character is in the range of 80-126. By repeatedly narrowing the range, we can determine the exact value of each character in the password.

---

## Bitwise Analysis

Since ASCII characters are represented by 7 bits (0-127), we can determine each character by checking one bit at a time. This requires only seven queries per character. MySQL's `bin()` function can be used to convert a character to its binary representation.

```sql
-- Get the binary representation of 'A'
SELECT bin(ord('A'));
```

| bin(ord('A')) |
| :--- |
| `1000001` |

### Bitwise Analysis Example

Using the same `users` table, we can extract the password by checking each bit of each character.

| username | password   |
| :------- | ---------- |
| `admin`  | `P@ssword` |

```sql
-- Check the first bit of the first character of the password
SELECT * FROM users WHERE username = 'admin' AND substr(bin(ord(substr(password, 1, 1))), 1, 1) = '1';

-- Check the second bit of the first character of the password
SELECT * FROM users WHERE username = 'admin' AND substr(bin(ord(substr(password, 1, 1))), 2, 1) = '1';
```

By repeating this for all seven bits, we can reconstruct the binary representation of the character. For the character 'P' (ASCII 80), which is `1010000` in binary, the query will only return a result for the first and third bits. All other bit checks will return an empty set. 